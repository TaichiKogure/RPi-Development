# Raspberry Pi OLED ディスプレイ情報システム - 取扱説明書

## バージョン 3.0

このドキュメントでは、Raspberry Pi用のOLEDディスプレイ情報システムの設定方法と使用方法について説明します。このシステムは日時、CPU使用率、温度をOLEDディスプレイに表示し、独立したスクロールテキストと拡張された3Dアニメーションを特徴としています。

## 目次

1. [システム概要](#システム概要)
2. [必要なハードウェア](#必要なハードウェア)
3. [必要なソフトウェア](#必要なソフトウェア)
4. [インストール方法](#インストール方法)
5. [プログラムの機能](#プログラムの機能)
6. [設定パラメータ](#設定パラメータ)
7. [トラブルシューティング](#トラブルシューティング)

## システム概要

このプログラムは、Raspberry Piに接続されたOLEDディスプレイに以下の情報を表示します：

- 現在の日付と時刻（上段）
- CPU使用率（中段）
- CPU温度（下段）

Ver3.0の主な特徴：

- **独立したテキストスクロール**: 各テキスト行が独立してランダムなタイミングでスクロールします
- **拡張された3Dアニメーション**: 立方体が画面内を移動しながら回転します
- **動的な速度変化**: スクロールと3Dアニメーションの速度が動的に変化します

## 必要なハードウェア

- Raspberry Pi（任意のモデル）
- SPI接続の128x64 OLEDディスプレイ（SSD1306コントローラ使用）
- ジャンパーワイヤー

### 配線方法

OLEDディスプレイとRaspberry Piの接続：

| OLEDピン | Raspberry Piピン |
|---------|-----------------|
| VCC     | 3.3V            |
| GND     | GND             |
| SCL     | SCK (GPIO11)    |
| SDA     | MOSI (GPIO10)   |
| RES     | GPIO24          |
| DC      | GPIO25          |
| CS      | GPIO8           |

## 必要なソフトウェア

- Python 3.6以上
- 以下のPythonライブラリ：
  - adafruit-blinka
  - adafruit-circuitpython-ssd1306
  - pillow
  - psutil
  - numpy

## インストール方法

1. 必要なライブラリをインストールします：

```bash
sudo apt-get update
sudo apt-get install -y python3-pip python3-pil python3-numpy
sudo pip3 install adafruit-blinka adafruit-circuitpython-ssd1306 psutil
```

2. SPI機能を有効にします：

```bash
sudo raspi-config
```

「Interface Options」→「SPI」→「Yes」を選択して有効にします。

3. プログラムファイルをダウンロードまたは作成します：

```bash
cd ~
mkdir -p RPi_Development01/ForZero/OLEDDisplay
cd RPi_Development01/ForZero/OLEDDisplay
# ここにDispVer3.0.pyファイルを配置します
```

4. プログラムを実行します：

```bash
python3 DispVer3.0.py
```

## プログラムの機能

### 1. 独立したテキストスクロール

Ver3.0では、3つのテキスト行（日時、CPU使用率、CPU温度）がそれぞれ独立してスクロールします：

- **上段（日時）**: 右から左へスクロール
- **中段（CPU使用率）**: 左から右へスクロール
- **下段（CPU温度）**: 右から左へスクロール

各行は：
- ランダムなタイミングでスクロールを開始
- ランダムな速度でスクロール
- スクロール中に速度が変化する可能性あり

### 2. 拡張された3Dアニメーション

3サイクルごとに表示される3Dアニメーションが強化されました：

- **移動する立方体**: 立方体が画面内を移動し、画面端で反射します
- **3軸回転**: X軸、Y軸、Z軸の3方向すべてで回転します
- **動的な速度変化**: 回転速度が時間とともに変化します

### 3. 動的な速度変化

テキストスクロールと3Dアニメーションの両方で速度が動的に変化します：

- **テキストスクロール**: 各行が独立して速度を変更
- **3Dアニメーション**: 回転速度が滑らかに変化
- **ランダム性**: 速度変化のタイミングと大きさがランダム

## 設定パラメータ

プログラム内の以下のパラメータを調整することで、動作をカスタマイズできます：

### 基本設定

```python
update_interval = 0.2  # 表示更新間隔（秒）
```

### スクロール設定

```python
scroll_speed_min = 1     # 最小スクロール速度（ピクセル数）
scroll_speed_max = 3     # 最大スクロール速度（ピクセル数）
sleep_time = 0.015       # スクロールの間隔（秒）
space = 30               # テキストの末尾に入れる空白の幅（スクロールの余白）

# スクロールのランダム性
scroll_random_chance = 0.01  # 各フレームでスクロール速度が変わる確率
scroll_delay_min = 0     # スクロール開始の最小遅延フレーム数
scroll_delay_max = 50    # スクロール開始の最大遅延フレーム数
```

### 3Dアニメーション設定

```python
animation_duration = 5.0   # アニメーション表示時間（秒）
animation_frames = 200     # アニメーションのフレーム数
animation_speed_min = 0.5  # 最小回転速度係数
animation_speed_max = 2.0  # 最大回転速度係数
speed_change_chance = 0.02 # 各フレームで速度が変わる確率
movement_enabled = True    # 立体が画面内を移動するかどうか
movement_speed_x = 0.5     # X軸方向の移動速度
movement_speed_y = 0.3     # Y軸方向の移動速度
```

### その他の設定

```python
cycles_before_animation = 3  # アニメーション表示までのスクロールサイクル数
```

## 設定例

### 速いスクロール、遅いアニメーション

```python
scroll_speed_min = 2
scroll_speed_max = 5
animation_speed_min = 0.3
animation_speed_max = 0.8
```

### 遅いスクロール、速いアニメーション

```python
scroll_speed_min = 0.5
scroll_speed_max = 1.5
animation_speed_min = 1.5
animation_speed_max = 3.0
```

### 移動なしの3Dアニメーション（中央固定）

```python
movement_enabled = False
```

### より頻繁な速度変化

```python
scroll_random_chance = 0.05
speed_change_chance = 0.1
```

## トラブルシューティング

### ディスプレイが表示されない

- OLEDディスプレイの配線を確認してください
- SPIが有効になっているか確認してください
- 必要なライブラリがすべてインストールされているか確認してください

### テキストが表示されない/正しく表示されない

- フォントファイルのパスが正しいか確認してください
- ディスプレイの解像度設定（WIDTH, HEIGHT）が正しいか確認してください

### 3Dアニメーションが表示されない

- アニメーションのパラメータ（特にサイズ）を調整してみてください
- CPUの負荷が高すぎないか確認してください

### プログラムが起動しない

エラーメッセージを確認し、以下を確認してください：
- すべての必要なライブラリがインストールされているか
- Pythonのバージョンが3.6以上か
- 必要なハードウェアが正しく接続されているか

## 更新履歴

### Ver3.0
- 独立したテキストスクロールを実装
- 3Dアニメーションに移動機能を追加
- 動的な速度変化を実装
- Z軸回転を追加
- 設定パラメータを拡張

### Ver2.1
- 3つのテキスト行が同時にスクロール
- 中央で回転する3Dアニメーション（X軸とY軸のみ）
- 固定速度のアニメーション

---

このドキュメントは2025年7月26日に最終更新されました。