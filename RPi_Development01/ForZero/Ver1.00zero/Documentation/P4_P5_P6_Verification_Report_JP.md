# P4、P5、P6検証レポート

## 概要
このレポートは、環境データ測定システムにおけるP4、P5、P6センサーノードとP1中央ハブとの互換性の検証結果をまとめたものです。検証プロセスには、各センサーノードのソフトウェア実装の確認と、すべてのノード間の一貫性の確保が含まれています。

## P1の構成
P1中央ハブは、P4、P5、P6センサーノードと連携するように適切に構成されています。構成には以下が含まれます：

- P4、P5、P6用のデータディレクトリ（RawData_P4、RawData_P5、RawData_P6）
- 3つのデバイスすべてのWiFiモニター構成
- データディレクトリの存在を確認する機能

## P4ソフトウェア実装

### メインプログラム（main.py）
- デバイスID：「P4」
- WiFi構成：
  - SSID：「RaspberryPi5_AP_Solo」
  - パスワード：「raspberry」
  - サーバーIP：「192.168.0.1」
  - サーバーポート：5000
- ピン構成：
  - LED_PIN：「LED」
  - I2C_SDA_PIN：0
  - I2C_SCL_PIN：1
  - UART_TX_PIN：8
  - UART_RX_PIN：9
- エラー処理：
  - ERROR_LOG_FILE：「/error_log_p4_solo.txt」

### WiFiクライアント（P4_wifi_client_debug.py）
- 以下のメソッドを持つWiFiClientクラス：
  - WiFiネットワークへの接続
  - サーバーへのデータ送信
  - エラー処理
  - 接続品質のモニタリング
- デフォルトのデバイスID：「P4」

### センサードライバー
- BME680センサードライバー（bme680.py）
  - 低レベル通信用のBME680_I2Cクラス
  - 簡略化されたインターフェース用のBME680クラス
  - 温度、湿度、気圧、ガス抵抗の読み取りメソッド
- MH-Z19C CO2センサードライバー（mhz19c.py）
  - 通信用のMHZ19Cクラス
  - CO2濃度の読み取り、校正、設定のメソッド

### エラー処理（P4_watchdog_debug.py）
- システム健全性監視用のWatchdogクラス
- エラー処理、ファイル同期、デバイスリセット用の関数
- メモリ監視機能

## P5ソフトウェア実装

### メインプログラム（main.py）
- デバイスID：「P5」
- WiFi構成：
  - SSID：「RaspberryPi5_AP_Solo」
  - パスワード：「raspberry」
  - サーバーIP：「192.168.0.1」
  - サーバーポート：5000
- ピン構成：
  - LED_PIN：「LED」
  - I2C_SDA_PIN：0
  - I2C_SCL_PIN：1
  - UART_TX_PIN：8
  - UART_RX_PIN：9
- エラー処理：
  - ERROR_LOG_FILE：「/error_log_p5_solo.txt」

### WiFiクライアント（P5_wifi_client_debug.py）
- 以下のメソッドを持つWiFiClientクラス：
  - WiFiネットワークへの接続
  - サーバーへのデータ送信
  - エラー処理
  - 接続品質のモニタリング
- デフォルトのデバイスID：「P5」

### センサードライバー
- BME680センサードライバー（bme680.py）
  - 低レベル通信用のBME680_I2Cクラス
  - 簡略化されたインターフェース用のBME680クラス
  - 温度、湿度、気圧、ガス抵抗の読み取りメソッド
- MH-Z19C CO2センサードライバー（mhz19c.py）
  - 通信用のMHZ19Cクラス
  - CO2濃度の読み取り、校正、設定のメソッド

### エラー処理（P5_watchdog_debug.py）
- システム健全性監視用のWatchdogクラス
- エラー処理、エラーログ記録、ファイル同期、デバイスリセット用の関数
- エラーログ初期化機能

## P6ソフトウェア実装

### メインプログラム（main.py）
- デバイスID：「P6」
- WiFi構成：
  - SSID：「RaspberryPi5_AP_Solo」
  - パスワード：「raspberry」
  - サーバーIP：「192.168.0.1」
  - サーバーポート：5000
- ピン構成：
  - LED_PIN：「LED」
  - I2C_SDA_PIN：0
  - I2C_SCL_PIN：1
  - UART_TX_PIN：8
  - UART_RX_PIN：9
- エラー処理：
  - ERROR_LOG_FILE：「/error_log_p6_solo.txt」

### WiFiクライアント（P6_wifi_client_debug.py）
- 以下のメソッドを持つWiFiClientクラス：
  - WiFiネットワークへの接続
  - サーバーへのデータ送信
  - エラー処理
  - 接続品質のモニタリング
- デフォルトのデバイスID：「P6」
- サーバーへのデータ送信用のDataTransmitterクラス

### センサードライバー
- BME680センサードライバー（bme680.py）
  - 低レベル通信用のBME680_I2Cクラス
  - 簡略化されたインターフェース用のBME680クラス
  - 温度、湿度、気圧、ガス抵抗の読み取りメソッド
- MH-Z19C CO2センサードライバー（mhz19c.py）
  - 通信用のMHZ19Cクラス
  - CO2濃度の読み取り、校正、設定のメソッド

### エラー処理（P6_watchdog_debug.py）
- システム健全性監視用のWatchdogクラス
- エラー処理、エラーログ記録、ファイル同期、デバイスリセット用の関数
- エラーログ初期化機能

## センサーノード間の一貫性

### デバイスIDとサーバー構成
すべてのセンサーノード（P4、P5、P6）は、正しいデバイスIDとサーバー構成を持っています：
- 各ノードは一意のデバイスID（「P4」、「P5」、または「P6」）を持っています
- すべてのノードは同じWiFi SSID（「RaspberryPi5_AP_Solo」）とパスワード（「raspberry」）を使用しています
- すべてのノードは同じサーバーIP（「192.168.0.1」）とポート（5000）を使用しています

### センサー初期化とデータ送信
すべてのセンサーノードは、センサーに対して同じピン構成を使用しています：
- I2C_SDA_PIN：0
- I2C_SCL_PIN：1
- UART_TX_PIN：8
- UART_RX_PIN：9

すべてのノードは同じセンサードライバー（bme680.pyとmhz19c.py）を同じインターフェースで使用しており、一貫したデータ収集と送信を確保しています。

### エラー処理とウォッチドッグの実装
すべてのセンサーノードは、類似したエラー処理とウォッチドッグの実装を持っています：
- 各ノードはシステム健全性監視用のWatchdogクラスを持っています
- 各ノードはエラー処理、ファイル同期、デバイスリセット用の関数を持っています
- 各ノードは一意のエラーログファイルパス（「/error_log_p4_solo.txt」、「/error_log_p5_solo.txt」、または「/error_log_p6_solo.txt」）を持っています

## 結論
検証プロセスにより、P4、P5、P6センサーノードが適切に実装され、P1中央ハブと連携するように構成されていることが確認されました。すべてのノードは、環境データの収集、P1への送信、エラー処理に必要なソフトウェアコンポーネントを備えています。すべてのノード間の一貫性により、環境データ測定システムの信頼性の高い運用が確保されています。

## 推奨事項
1. **テスト**：すべてのセンサーノードを接続した状態でシステムの徹底的なテストを実施し、適切な動作を確認する。
2. **ドキュメント**：システムドキュメントを更新し、P4、P5、P6センサーノードに関する情報を含める。
3. **モニタリング**：すべてのセンサーノードのパフォーマンスを追跡し、問題を検出するためのモニタリングシステムを実装する。
4. **バックアップ**：障害発生時に迅速に復旧できるよう、センサーノード構成の定期的なバックアップを作成する。

## バージョン情報
- **レポート日付**：2025年7月22日
- **システムバージョン**：1.0.0
- **互換性のあるハードウェア**：Raspberry Pi 5、Raspberry Pi Pico 2W
- **互換性のあるセンサー**：BME680、MH-Z19B/C