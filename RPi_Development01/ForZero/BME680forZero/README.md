# BME680 環境データ測定プログラム

## 概要
このプログラムは、BME680環境センサーから温度、湿度、気圧、ガス抵抗値のデータを5秒ごとに読み取り、表示するMicroPythonプログラムです。Raspberry Pi PicoやRaspberry Pi Pico Wなどの、MicroPythonが動作するマイコンボードで利用できます。

## 機能
- BME680センサーからの環境データ（温度、湿度、気圧、ガス抵抗値）を5秒ごとに読み取り
- 測定値をタイムスタンプ付きで表示
- 両方のI2Cアドレス（0x76と0x77）に対応
- エラー処理と自動再試行機能
- メモリ管理の最適化

## 必要なハードウェア
- MicroPythonが動作するマイコンボード（Raspberry Pi Pico/Pico W推奨）
- BME680環境センサー（I2C接続）
- ジャンパーワイヤー
- ブレッドボード（必要に応じて）

## 配線方法
BME680センサーとマイコンボードを以下のように接続します：

| BME680ピン | マイコンボードピン |
|------------|-------------------|
| VCC        | 3.3V              |
| GND        | GND               |
| SCL        | GPIO 1 (Pin 2)    |
| SDA        | GPIO 0 (Pin 1)    |

## ソフトウェア要件
- MicroPython ファームウェア（v1.17以降推奨）
- bme680.py ドライバファイル

## セットアップ手順

### 1. MicroPythonのインストール
マイコンボードにMicroPythonがまだインストールされていない場合は、[MicroPython公式サイト](https://micropython.org/download/)から適切なファームウェアをダウンロードし、インストールしてください。

### 2. 必要なファイルの転送
以下のファイルをマイコンボードに転送します：
- `bme680.py` - BME680センサードライバ
- `BME680forZ_ver1.0.py` - メインプログラム

ファイルの転送には、Thonny IDEやrshellなどのツールが利用できます。

#### Thonny IDEを使用する場合：
1. Thonny IDEを起動し、マイコンボードを接続します
2. 「表示」→「ファイル」を選択してファイルブラウザを表示
3. `bme680.py`と`BME680forZ_ver1.0.py`をマイコンボードのルートディレクトリにドラッグ＆ドロップ

### 3. プログラムの実行
マイコンボードに接続したThonny IDEまたはREPLから、以下のコマンドを実行します：

```python
import BME680forZ_ver1.0
```

または、マイコンボードを再起動時に自動実行するには、ファイル名を`main.py`に変更してください。

## 使用方法
プログラムを実行すると、以下の動作をします：

1. I2Cバスの初期化とBME680センサーの検出
2. センサーの初期化（0x77アドレスで試行し、失敗した場合は0x76で再試行）
3. 5秒ごとに環境データを読み取り、表示
4. エラーが発生した場合は自動的に再試行

プログラムを終了するには、`Ctrl+C`を押します。

## 出力例
```
===== BME680 環境データ測定プログラム Ver.1.0 =====
5秒ごとにBME680センサーからデータを読み取ります
Ctrl+Cで終了できます
================================================
I2Cバスを初期化しています...
I2Cデバイスが見つかりました: ['0x77']
BME680センサーを初期化しています...
BME680センサーを0x77アドレスで初期化しました
初期化完了。データ取得を開始します...
[1] 2025-07-26 11:30:15
  温度: 25.21 °C
  湿度: 45.32 %
  気圧: 1013.25 hPa
  ガス抵抗: 12043 Ω
----------------------------------------
[2] 2025-07-26 11:30:20
  温度: 25.23 °C
  湿度: 45.30 %
  気圧: 1013.24 hPa
  ガス抵抗: 12102 Ω
----------------------------------------
```

## トラブルシューティング

### センサーが検出されない場合
- 配線が正しいか確認してください
- I2Cアドレスが正しいか確認してください（通常は0x76または0x77）
- センサーの電源（3.3V）が正しく供給されているか確認してください

### エラーメッセージが表示される場合
- `bme680.py`ファイルがマイコンボードに正しく転送されているか確認してください
- マイコンボードのMicroPythonバージョンが最新であるか確認してください

## 注意事項
- ガス抵抗値は、センサーの暖機運転が完了するまで安定しない場合があります（通常は数分程度）
- 高精度な測定のためには、センサーを適切な場所に設置し、直射日光や熱源から離してください

## ライセンス
このプログラムはMITライセンスの下で公開されています。詳細については、bme680.pyファイル内のライセンス情報を参照してください。

## バージョン履歴
- v1.0 (2025-07-26): 初回リリース