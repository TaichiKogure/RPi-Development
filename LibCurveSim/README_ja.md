# リチウムイオン電池充放電曲線シミュレーションツール

## 概要

このプロジェクトは、三元系正極（NMC）と黒鉛負極を組み合わせたリチウムイオン電池の充電・放電曲線をシミュレーションするためのツール群です。電池の内部抵抗、容量、充放電レートなどのパラメータを調整して、様々な条件下での電池の挙動を可視化することができます。

## ファイル構成

このプロジェクトは以下の4つのPythonスクリプトで構成されています：

1. **Test01.py** - 基本的な充放電曲線シミュレーション（英語版）
2. **Test01S.py** - スムージング機能を追加した充放電曲線シミュレーション
3. **Test02.py** - 内部抵抗の増加が電池性能に与える影響を示すシミュレーション
4. **Test01SAh.py** - SOCではなくAh単位で容量を表示し、スムージング機能も備えたシミュレーション

## 各スクリプトの詳細

### Test01.py

基本的な充放電曲線シミュレーションを行うスクリプトです。元のスクリプトの日本語部分を英語に翻訳したバージョンです。

#### 主な機能
- 定電流/定電圧（CC/CV）充電シミュレーション
- 定電流（CC）放電シミュレーション
- 電圧-SOC曲線と電圧-容量曲線の生成

#### 使用方法
```
python Test01.py [オプション]
```

#### 主なオプション
- `--capacity` - 電池容量[Ah]（デフォルト: 3.0）
- `--charge_c_rate` - 充電Cレート（デフォルト: 0.5）
- `--discharge_c_rate` - 放電Cレート（デフォルト: 0.5）
- `--resistance` - 内部抵抗[Ω]（デフォルト: 0.05）
- `--dt` - シミュレーション刻み時間[秒]（デフォルト: 1）
- `--save_prefix` - 結果をPNGファイルで保存する際の接頭語
- `--no_show` - グラフを表示せず保存のみ行う

### Test01S.py

Test01.pyの機能に加えて、曲線のスムージング機能を追加したバージョンです。これにより、シミュレーションデータのノイズが軽減され、より滑らかで見やすい曲線が得られます。

#### 追加機能
- Savitzky-Golayフィルタを使用した曲線のスムージング
- スムージングレベルの調整機能

#### 使用方法
```
python Test01S.py [オプション]
```

#### 追加オプション
- `--smoothing` - スムージングレベル（デフォルト: 5、値が大きいほど滑らかになる）

#### スムージングアルゴリズムについて
このスクリプトでは、Savitzky-Golayフィルタを使用して曲線をスムージングしています。このフィルタは、多項式近似と移動窓を組み合わせたもので、データの傾向を保持しながらノイズを軽減する特徴があります。

スムージングレベルパラメータは、フィルタの窓サイズを制御します。値が大きいほど、より広い範囲のデータポイントを使用して平滑化を行うため、曲線はより滑らかになりますが、細かい特徴が失われる可能性があります。逆に、値が小さいと、元のデータの特徴をより保持しますが、ノイズの軽減効果は小さくなります。

### Test02.py

内部抵抗の増加が電池性能に与える影響を示すシミュレーションを行うスクリプトです。通常の内部抵抗と増加した内部抵抗の両方でシミュレーションを実行し、結果を比較します。

#### 主な機能
- 通常の内部抵抗と増加した内部抵抗での充放電シミュレーション
- 両者の結果を同一グラフ上で比較
- 内部抵抗増加による使用可能容量の減少を可視化

#### 使用方法
```
python Test02.py [オプション]
```

#### 追加オプション
- `--resistance_factor` - 内部抵抗の増加倍率（デフォルト: 3.0）

#### 内部抵抗の影響について
内部抵抗が増加すると、以下のような影響が電池性能に現れます：

1. **電圧降下の増加**: 放電時には端子電圧が低下し、充電時には端子電圧が上昇します。これにより、設定された電圧制限（上限・下限）に早く到達するため、使用可能な容量が減少します。

2. **使用可能容量の減少**: 内部抵抗が高いと、同じ電流でも大きな電圧降下が発生するため、カットオフ電圧に早く到達し、実際に使用できる容量が減少します。

3. **発熱の増加**: 内部抵抗が高いと、I²R損失による発熱が増加します（このシミュレーションでは発熱は考慮していません）。

4. **充電効率の低下**: 内部抵抗が高いと、充電時のエネルギー損失が増加し、充電効率が低下します。

Test02.pyでは、これらの影響を視覚的に確認することができます。特に、放電曲線の比較グラフでは、内部抵抗の増加によって使用可能容量がどれだけ減少するかを明確に示しています。

### Test01SAh.py

SOC（充電状態）ではなく、Ah（アンペア時）単位で容量を表示するスクリプトです。また、スムージング機能も備えており、微分容量分析（dQ/dV）も提供します。

#### 主な機能
- SOCからAh単位への変換
- 電圧-容量（Ah）曲線の生成
- 微分容量分析（dQ/dV）曲線の生成
- クーロン効率の計算と表示

#### 使用方法
```
python Test01SAh.py [オプション]
```

#### オプション
Test01S.pyと同じオプションを使用できます。

#### 微分容量分析について
微分容量分析（dQ/dV）は、電池の充放電過程における相転移や反応メカニズムを理解するのに役立つ手法です。電圧の変化に対する容量の変化率（dQ/dV）をプロットすることで、電池内部で起こる電気化学反応のピークを識別することができます。

このスクリプトでは、充電と放電の両方について微分容量曲線を生成し、電池の挙動をより詳細に分析することができます。

## 使用例

### 基本的な充放電曲線の生成
```
python Test01.py --capacity 3.0 --charge_c_rate 0.5 --discharge_c_rate 0.5
```

### スムージングを適用した充放電曲線の生成
```
python Test01S.py --capacity 3.0 --smoothing 7
```

### 内部抵抗の影響を確認
```
python Test02.py --resistance 0.05 --resistance_factor 3.0
```

### Ah単位での容量表示と微分容量分析
```
python Test01SAh.py --capacity 3.0 --smoothing 7
```

## 注意事項

1. これらのシミュレーションは、簡略化されたモデルに基づいています。実際の電池の挙動は、温度、劣化状態、製造ばらつきなど、多くの要因によって影響を受けます。

2. OCV-SOCテーブルは文献から引用した値を使用しており、特定のNMC/黒鉛電池の特性を反映しています。異なる化学組成や設計の電池では、異なる特性を示す可能性があります。

3. スムージングレベルを高く設定しすぎると、データの重要な特徴が失われる可能性があります。適切な値を選択することが重要です。

## まとめ

このツール群を使用することで、リチウムイオン電池の充放電特性を様々な条件下でシミュレーションし、視覚化することができます。特に、内部抵抗の影響や容量の表示方法を変えることで、電池の性能をより深く理解することができます。

また、スムージング機能を使用することで、シミュレーションデータをより見やすく、解釈しやすくすることができます。微分容量分析は、電池内部の電気化学反応についての洞察を得るのに役立ちます。

これらのツールは、電池の設計、評価、教育目的など、様々な用途に活用することができます。