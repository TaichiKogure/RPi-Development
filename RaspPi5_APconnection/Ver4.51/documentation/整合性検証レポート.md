# P1, P2, P3の整合性検証レポート - Ver4.44

## 概要

このレポートでは、Raspberry Pi 5（P1）とRaspberry Pi Pico 2W（P2、P3）間の設定の整合性を検証した結果をまとめています。特にWiFi設定とデータ通信に関する整合性に焦点を当てています。

## 検証日時

2025年7月6日

## 検証項目

1. P1のアクセスポイント設定
2. P2のWiFi接続設定
3. P3のWiFi接続設定
4. P2とP3のセンサードライバー
5. P2とP3のエラー処理機能

## 検証結果

### 1. P1のアクセスポイント設定

P1のアクセスポイント設定は以下の通りです：

- SSID: `RaspberryPi5_AP_Solo`
- パスワード: `raspberry`
- IPアドレス: `192.168.0.1`
- ネットマスク: `255.255.255.0`
- DHCPレンジ: `192.168.0.50` から `192.168.0.150`
- ポート: `5000`（データ収集サーバー）

これらの設定は `P1_ap_setup_solo44.py` の `DEFAULT_CONFIG` で定義されています。

### 2. P2のWiFi接続設定

P2のWiFi接続設定は以下の通りです：

- SSID: `RaspberryPi5_AP_Solo`
- パスワード: `raspberry`
- サーバーIP: `192.168.0.1`
- サーバーポート: `5000`
- デバイスID: `P2`

これらの設定は `P2_software_solo44/main.py` で定義されています。

### 3. P3のWiFi接続設定

P3のWiFi接続設定は以下の通りです：

- SSID: `RaspberryPi5_AP_Solo`
- パスワード: `raspberry`
- サーバーIP: `192.168.0.1`
- サーバーポート: `5000`
- デバイスID: `P3`

これらの設定は `P3_software_solo44/main.py` で定義されています。

### 4. P2とP3のセンサードライバー

P2とP3は同じセンサードライバーを使用しています：

- BME680センサードライバー: `bme680.py`
- MH-Z19Cセンサードライバー: `mhz19c.py`

両方のデバイスでセンサードライバーが正しく設定されていることを確認しました。

### 5. P2とP3のエラー処理機能

P2とP3は同様のエラー処理機能を持っていますが、以下の点が異なります：

- P2のエラーログファイル: `/error_log_p2_solo44.txt`
- P3のエラーログファイル: `/error_log_p3_solo44.txt`

両方のデバイスでウォッチドッグタイマーが8秒に設定されており、自動再起動機能が実装されています。

## 整合性の確認

P1、P2、P3の設定を検証した結果、以下の点で整合性が確認されました：

1. **WiFi接続設定**: P2とP3は、P1のアクセスポイント設定と一致するSSID、パスワード、IPアドレスを使用しています。
2. **デバイス識別**: P2とP3は異なるデバイスIDを使用しており、P1はデータ送信元を正しく識別できます。
3. **センサー設定**: P2とP3は同じセンサードライバーを使用しており、同様のデータ形式でP1に送信します。
4. **エラー処理**: P2とP3は同様のエラー処理機能を持っており、安定した動作が期待できます。

## 実施した変更

P3のソフトウェアを整備するために、以下の変更を実施しました：

1. `P3_watchdog_solo44.py` の作成: P2のウォッチドッグ機能をP3用に修正
2. `P3_wifi_client_solo44.py` の作成: P2のWiFiクライアント機能をP3用に修正
3. `main.py` の作成: P2のメインプログラムをP3用に修正
4. `P2_P3_ソフトウェア説明.md` の作成: P2とP3のソフトウェア構造と違いを説明するドキュメント

## 結論

P1、P2、P3の設定は整合性が取れており、システム全体として正常に動作することが期待できます。P2とP3は同じ構造を持ちながらも、デバイスIDとエラーログファイルの違いにより、P1は両方のデバイスからのデータを区別して処理できます。

## 推奨事項

1. システム起動時は、まずP1のアクセスポイントを起動してから、P2とP3を起動することを推奨します。
2. P2とP3のセンサー読み取り間隔は30秒に設定されていますが、必要に応じて調整可能です。
3. エラーが発生した場合は、各デバイスのエラーログファイルを確認してください。
4. P1のWebインターフェースで、P2とP3からのデータが正しく表示されることを定期的に確認してください。