# BME680 環境データ測定プログラム (標準Python版)

## 概要
このプログラムは、BME680環境センサーから温度、湿度、気圧、ガス抵抗値のデータを5秒ごとに読み取り、表示する標準Python用プログラムです。Raspberry Piなどの、標準Pythonが動作するコンピュータで利用できます。

## 機能
- BME680センサーからの環境データ（温度、湿度、気圧、ガス抵抗値）を5秒ごとに読み取り
- 測定値をタイムスタンプ付きで表示
- 両方のI2Cアドレス（0x76と0x77）に対応
- エラー処理と自動再試行機能
- 2種類の実装方法を提供（Adafruit CircuitPythonライブラリ使用版とsmbus2ライブラリ使用版）

## 必要なハードウェア
- Raspberry Pi（または他のLinuxコンピュータ）
- BME680環境センサー（I2C接続）
- ジャンパーワイヤー
- ブレッドボード（必要に応じて）

## 配線方法
BME680センサーとRaspberry Piを以下のように接続します：

| BME680ピン | Raspberry Piピン |
|------------|-----------------|
| VCC        | 3.3V            |
| GND        | GND             |
| SCL        | SCL (GPIO 3, Pin 5) |
| SDA        | SDA (GPIO 2, Pin 3) |

## ソフトウェア要件

### 共通要件
- Python 3.6以上

### Adafruit CircuitPythonライブラリ使用版（BME680forZ_ver2.0.py）
- adafruit-circuitpython-bme680
- adafruit-blinka (board, busioモジュールを提供)

### smbus2ライブラリ使用版（BME680forZ_ver2.0_smbus.py）
- smbus2

## セットアップ手順

### 1. I2Cの有効化（Raspberry Pi）
Raspberry Piで以下のコマンドを実行し、I2Cを有効にします：

```bash
sudo raspi-config
```

「Interface Options」→「I2C」を選択し、有効にします。

### 2. 必要なパッケージのインストール

#### Adafruit CircuitPythonライブラリ使用版の場合：
```bash
sudo apt-get update
sudo apt-get install -y python3-pip
sudo pip3 install adafruit-circuitpython-bme680
sudo pip3 install adafruit-blinka
```

#### smbus2ライブラリ使用版の場合：
```bash
sudo apt-get update
sudo apt-get install -y python3-pip
sudo pip3 install smbus2
```

### 3. プログラムファイルの準備
以下のファイルをRaspberry Piに転送またはダウンロードします：

- `BME680forZ_ver2.0.py` - Adafruit CircuitPythonライブラリ使用版
- `BME680forZ_ver2.0_smbus.py` - smbus2ライブラリ使用版

### 4. プログラムの実行

#### Adafruit CircuitPythonライブラリ使用版の場合：
```bash
python3 BME680forZ_ver2.0.py
```

#### smbus2ライブラリ使用版の場合：
```bash
python3 BME680forZ_ver2.0_smbus.py
```

## 使用方法
プログラムを実行すると、以下の動作をします：

1. I2Cバスの初期化とBME680センサーの検出
2. センサーの初期化（0x77アドレスで試行し、失敗した場合は0x76で再試行）
3. 5秒ごとに環境データを読み取り、表示
4. エラーが発生した場合は自動的に再試行

プログラムを終了するには、`Ctrl+C`を押します。

## 出力例
```
===== BME680 環境データ測定プログラム Ver.2.0 (標準Python版) =====
5秒ごとにBME680センサーからデータを読み取ります
Ctrl+Cで終了できます
================================================
I2Cバスを初期化しています...
BME680センサーを初期化しています...
BME680センサーを0x77アドレスで初期化しました
初期化完了。データ取得を開始します...
[1] 2025-07-26 11:30:15
  温度: 25.21 °C
  湿度: 45.32 %
  気圧: 1013.25 hPa
  ガス抵抗: 12043 Ω
----------------------------------------
[2] 2025-07-26 11:30:20
  温度: 25.23 °C
  湿度: 45.30 %
  気圧: 1013.24 hPa
  ガス抵抗: 12102 Ω
----------------------------------------
```

## 実装の違いと選択ガイド

### Adafruit CircuitPythonライブラリ使用版（BME680forZ_ver2.0.py）
- **メリット**：
  - Adafruit社が提供する高品質なライブラリを使用
  - 複雑なセンサーの計算ロジックが抽象化されている
  - 他のAdafruit製センサーとの互換性が高い
  - ドキュメントが充実している
- **デメリット**：
  - 依存ライブラリが多い
  - インストールに時間がかかる場合がある
- **推奨ユーザー**：
  - 複数のAdafruit製センサーを使用している方
  - 簡単にセットアップしたい方
  - 他のCircuitPythonプロジェクトと統合したい方

### smbus2ライブラリ使用版（BME680forZ_ver2.0_smbus.py）
- **メリット**：
  - 依存ライブラリが少ない（smbus2のみ）
  - I2C通信の詳細を理解できる
  - カスタマイズが容易
- **デメリット**：
  - センサーの計算ロジックが複雑
  - 一部の計算が簡略化されている（完全な精度を得るには追加の実装が必要）
- **推奨ユーザー**：
  - 最小限の依存関係でプログラムを実行したい方
  - I2C通信の仕組みを学びたい方
  - プログラムをカスタマイズしたい方

## トラブルシューティング

### センサーが検出されない場合
- 配線が正しいか確認してください
- I2Cアドレスが正しいか確認してください（通常は0x76または0x77）
- センサーの電源（3.3V）が正しく供給されているか確認してください
- I2Cが有効になっているか確認してください：
  ```bash
  sudo i2cdetect -y 1
  ```
  このコマンドを実行して、BME680のアドレス（0x76または0x77）が表示されるか確認してください

### ライブラリのインストールに関する問題
- インターネット接続を確認してください
- Pythonのバージョンが3.6以上であることを確認してください：
  ```bash
  python3 --version
  ```
- pipが最新であることを確認してください：
  ```bash
  pip3 install --upgrade pip
  ```

### 権限の問題
- I2Cデバイスへのアクセス権限がない場合は、以下のコマンドを実行してください：
  ```bash
  sudo usermod -a -G i2c $USER
  ```
  その後、ログアウトして再度ログインしてください。

### エラーメッセージが表示される場合
- エラーメッセージを確認し、問題を特定してください
- 必要なライブラリがすべてインストールされているか確認してください
- Pythonのバージョンが互換性があるか確認してください

## 注意事項
- ガス抵抗値は、センサーの暖機運転が完了するまで安定しない場合があります（通常は数分程度）
- 高精度な測定のためには、センサーを適切な場所に設置し、直射日光や熱源から離してください
- smbus2ライブラリ使用版では、一部の計算が簡略化されているため、完全な精度を得るには追加の実装が必要な場合があります

## ライセンス
このプログラムはMITライセンスの下で公開されています。

## バージョン履歴
- v2.0 (2025-07-26): 標準Python版初回リリース（Adafruit CircuitPythonライブラリ使用版とsmbus2ライブラリ使用版）
- v1.0 (2025-07-26): MicroPython版初回リリース